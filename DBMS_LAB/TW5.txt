


CREATE TABLE DEPARTMENT(
  DNO VARCHAR(20) PRIMARY KEY,
  DNAME VARCHAR(20),
  MGRSTARTDATE DATE,
  MGRSSN VARCHAR(20)
);

CREATE TABLE EMPLOYEE(
 SSN VARCHAR(20) PRIMARY KEY,
 FNAME VARCHAR(20),
 LNAME VARCHAR(20),
 ADDRESS VARCHAR(20),
 SEX VARCHAR(7),
 SALARY INT,
 SUPERSSN VARCHAR(20),
 DNO VARCHAR(20),
 FOREIGN KEY(SUPERSSN) REFERENCES EMPLOYEE(SSN),
 FOREIGN KEY(DNO) REFERENCES DEPARTMENT(DNO)
);


ALTER TABLE DEPARTMENT ADD FOREIGN KEY(MGRSSN) REFERENCES EMPLOYEE(SSN);

CREATE TABLE DLOCATION(
   DLOC VARCHAR(20),
   DNO VARCHAR(20),
   PRIMARY KEY(DNO,DLOC),
   FOREIGN KEY(DNO) REFERENCES DEPARTMENT(DNO)
  );

CREATE TABLE PROJECT(
 PNO INTEGER PRIMARY KEY,
 PNAME VARCHAR(20),
 PLOCATION VARCHAR(20),
 DNO VARCHAR(20),
 FOREIGN KEY(DNO) REFERENCES DEPARTMENT(DNO)
);


CREATE TABLE WORKS_ON(
  HOURS INTEGER,
  SSN VARCHAR(20),
  PNO INTEGER,
  PRIMARY KEY(SSN,PNO),
  FOREIGN KEY(SSN) REFERENCES EMPLOYEE(SSN),
  FOREIGN KEY(PNO) REFERENCES PROJECT(PNO)
 );

 
INSERT INTO EMPLOYEE VALUES('ECE1','JOHN','BOB','BANGALURE','MALE',450000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('IT1','ANUP','K','PUNE','MALE',500000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('ACC1','SARA','KE','VIJAYAPURA','FEMALE',350000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('CSE1','ANUSHKA','SHINDHE','MYSORE','FEMALE',750000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('ISE1','JHANVI','J','DHARAWAD','FEMALE',550000,NULL,NULL);

INSERT INTO EMPLOYEE VALUES('CSE2','AKSHAY','J','BANGALURE','MALE',850000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('CSE3','SUNNY','J','HUBBALLI','FEMALE',950000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('CSE4','KALPANA','M','PUNE','FEMALE',760000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('CSE5','AMRUTA','M','KOLAKATTA','FEMALE',860000,NULL,NULL);
INSERT INTO EMPLOYEE VALUES('CSE6','VIJAY','P','YADAGIRI','MALE',680000,NULL,NULL);

INSERT INTO DEPARTMENT VALUES('1','ACC','01-JAN-01','ACC1');
INSERT INTO DEPARTMENT VALUES('2','IT','07-FEB-16','IT1');
INSERT INTO DEPARTMENT VALUES('3','ECE','08-MAR-08','ECE1');
INSERT INTO DEPARTMENT VALUES('4','ISE','09-JUN-15','ISE1');
INSERT INTO DEPARTMENT VALUES('5','CSE','04-AUG-02','CSE1');





UPDATE EMPLOYEE SET SUPERSSN=NULL,DNO='1' WHERE SSN='ACC1';
UPDATE EMPLOYEE SET SUPERSSN=NULL,DNO='2' WHERE SSN='IT1';
UPDATE EMPLOYEE SET SUPERSSN=NULL,DNO='3' WHERE SSN='ECE1';
UPDATE EMPLOYEE SET SUPERSSN=NULL,DNO='4' WHERE SSN='ISE1';
UPDATE EMPLOYEE SET SUPERSSN='CSE2',DNO='5' WHERE SSN='CSE1';

UPDATE EMPLOYEE SET SUPERSSN='CSE3',DNO='5' WHERE SSN='CSE2';
UPDATE EMPLOYEE SET SUPERSSN='CSE4',DNO='5' WHERE SSN='CSE3';
UPDATE EMPLOYEE SET SUPERSSN='CSE5',DNO='5' WHERE SSN='CSE4';
UPDATE EMPLOYEE SET SUPERSSN='CSE6',DNO='5' WHERE SSN='CSE5';
UPDATE EMPLOYEE SET SUPERSSN=NULL,DNO='5' WHERE SSN='CSE6';


INSERT INTO DLOCATION VALUES('BANGALURE','1');
INSERT INTO DLOCATION VALUES('BANGALURE','2');
INSERT INTO DLOCATION VALUES('BANGALURE','3');
INSERT INTO DLOCATION VALUES('MANGALURE','4');
INSERT INTO DLOCATION VALUES('MANGALURE','5');


INSERT INTO PROJECT VALUES(100,'IOT','BANGALURE','5');
INSERT INTO PROJECT VALUES(101,'CLOUD','BANGALURE','1');
INSERT INTO PROJECT VALUES(102,'BIGDATA','MANGLURE','4');
INSERT INTO PROJECT VALUES(103,'SENSORS','MANGALURE','3');
INSERT INTO PROJECT VALUES(104,'BANK MANAGEMENT','BANGALURE','2');
INSERT INTO PROJECT VALUES(105,'SALARY MANAGEMENT','BANGALURE','1');



INSERT INTO WORKS_ON VALUES(4,'ACC1',100);
INSERT INTO WORKS_ON VALUES(6,'IT1',105);
INSERT INTO WORKS_ON VALUES(8,'ECE1',103);
INSERT INTO WORKS_ON VALUES(7,'ISE1',104);
INSERT INTO WORKS_ON VALUES(3,'CSE1',101);
INSERT INTO WORKS_ON VALUES(2,'CSE2',102);




QUERIES



1)


(SELECT DISTINCT P.PNO 
FROM PROJECT P, DEPARTMENT D, EMPLOYEE E
WHERE E.DNO=D.DNO AND
      D.MGRSSN=E.SSN AND
       E.LNAME='J')
UNION
(SELECT DISTINCT P.PNO 
FROM PROJECT P, WORKS_ON W, EMPLOYEE E 
WHERE P.PNO=W.PNO AND
      E.SSN=W.SSN AND
     E.LNAME='J');





2)





SELECT E.FNAME, E.LNAME, 1.1*E.SALARY 
AS INCR_SAL 
FROM EMPLOYEE E,WORKS_ON W, PROJECT P 
WHERE E.SSN=W.SSN AND 
     W.PNO=P.PNO AND
      P.PNAME='IOT';












3)





SELECT SUM (E.SALARY), MAX (E.SALARY), MIN (E.SALARY), AVG (E.SALARY)
FROM EMPLOYEE E, DEPARTMENT D 
WHERE E.DNO=D.DNO AND
      D.DNAME='ACC';



4)





SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
WHERE NOT EXISTS(
		(SELECT PNO FROM PROJECT WHERE DNO=5) 
		MINUS
		(SELECT PNO FROM WORKS_ON WHERE E.SSN=SSN)
	);



5)





SELECT D.DNO, COUNT (*)
FROM DEPARTMENT D, EMPLOYEE E
WHERE D.DNO=E.DNO AND 
E.SALARY>600000 AND
 D.DNO IN (SELECT E.DNO
          FROM EMPLOYEE E
          GROUP BY E.DNO
          HAVING COUNT (*)>5)
          GROUP BY D.DNO;
 









